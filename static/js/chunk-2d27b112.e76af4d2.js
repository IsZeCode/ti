(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d27b112"],{"386d":function(e,n,t){"use strict";var r=t("cb7c"),o=t("83a1"),i=t("5f1b");t("214f")("search",1,(function(e,n,t,a){return[function(t){var r=e(this),o=void 0==t?void 0:t[n];return void 0!==o?o.call(t,r):new RegExp(t)[n](String(r))},function(e){var n=a(t,e,this);if(n.done)return n.value;var c=r(e),u=String(this),s=c.lastIndex;o(s,0)||(c.lastIndex=0);var l=i(c,u);return o(c.lastIndex,s)||(c.lastIndex=s),null===l?-1:l.index}]}))},"70eb":function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));t("6c7b"),t("55dd"),t("a481");var r=t("2d36"),o=t("4360");function i(e){var n=e.items,t=e.predict,r=e.reason,o=e.filter_record,i=n.length;n=t(n);var a=n.length,c=i-a;return 0===c||(o[r]=c),n}function a(e,n){var t=n.problem_range_start,a=n.problem_range_end,s=n.shuffle_problem,l=n.shuffle_problem_options,f=n.new_problem,d=n.combo_problem,p=n.problem_max_num;t=t||1,a=a||e.length,s=s||!1,l=l||!1,f=f||!1,d=d||0,p=p||0;var b=o["a"].state.problems.current_problems,m={},h=e;return h=i({items:h,predict:function(e){return e.filter((function(e){return e}))},reason:"重复的题目",filter_record:m}),h=i({items:h,predict:function(e){return e.slice(t-1,a||e.length)},reason:"筛选题目范围",filter_record:m}),s&&(h=Object(r["b"])(h)),u(h,l),c(h),d&&(h=i({items:h,predict:function(e){return e.filter((function(e){return(b[e.id]&&b[e.id].combo_kill||0)<d}))},reason:"筛选连对",filter_record:m})),f&&(h=i({items:h,predict:function(e){return e.filter(e.filter((function(e){return!(b[e.id]&&b[e.id].total)})))},reason:"筛选新题",filter_record:m})),p>0&&(h=i({items:h,predict:function(e){return e.slice(0,p)},reason:"筛选最大刷题数",filter_record:m})),{items:h,filter_record:m}}function c(e){e.map((function(e){if(e.options){var n=e.analysis;n?e.option_map&&(e.option_map.map((function(e,t){n=n.replace("{{OPT:".concat(e+1,"}}"),"[".concat(t+1,"]"))})),e.analysis=n):e.analysis="暂无题解"}}))}function u(e,n){var t=function(e,n,t){var r=n.map((function(t,r){var o=e[r];return n[o]})),o={};e.map((function(e,n){o[e]=n}));var i=function(e){return o[e-1]+1},a=t.length?t.map(i).sort((function(e,n){return e-n})):i(t);return[r,a]};e.map((function(e){if(e.options){var o=e.options,i=e.answer,a=e.analysis,c=function(e){return e&&e>0&&e<=o.length};i&&i.length?(i=i.filter(c),i.length||(i=[1],a="(该题答案存在问题)".concat(a))):c(i)||(i=1,a="(该题答案存在问题)".concat(a));var u=new Array(o.length).fill(0).map((function(e,n){return n}));if(n){console.log("start shuffle options"),u=Object(r["b"])(u);var s=t(u,o,i,a);e.options=s[0],e.answer=s[1]}e.option_map=u}}))}function s(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e;return new Promise((function(e,r){var o={};t=t.map((function(e){var n=Object.assign({},e);return n.id||(n.id="".concat(e.content).concat(JSON.stringify(e.answer))),o[n.id]?(o[n.id]++,null):(o[n.id]=1,n.completed=null,n)}));var i=t.length,c=a(t,n),u=c.items,s=c.filter_record;return t=u.map((function(e,n){return Object.assign({page_index:n},e)})),e({problems:t,duplicated:o,total_count:i,filter_record:s})}))}},"83a1":function(e,n){e.exports=Object.is||function(e,n){return e===n?0!==e||1/e===1/n:e!=e&&n!=n}},9554:function(e,n,t){"use strict";t.d(n,"b",(function(){return o})),t.d(n,"a",(function(){return i})),t.d(n,"c",(function(){return a}));t("ac6a"),t("456d"),t("28a5");function r(e,n,t){n||(n="name"),e[n]||(e[n]=[]),e[n].push(t)}function o(e){if(!e)return{};var n=e.content;if(!n)return{};var t=n.split(" "),o={};return t.map((function(e){if(e){var n=e.indexOf(":");if(-1===n)return r(o,"name",e);var t=e.substring(0,n),i=e.substring(n+1);return r(o,t,i)}})),Object.keys(e).filter((function(e){return"content"!==e})).map((function(n){e[n]=null})),Object.keys(o).map((function(n){e[n]=o[n].join(";")})),o}function i(e){return Object.keys(e).filter((function(n){return"content"!==n&&e[n]})).map((function(n){return{k:n,v:e[n].split(";")}}))}function a(e){if(!e)return{};var n=i(e).map((function(e){return"name"===e.k?e.v.join(";"):"".concat(e.k,":").concat(e.v.join(";"))})).join(" ");return e.content=n,n}},e2dd:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"c",(function(){return a})),t.d(n,"b",(function(){return c}));var r=t("589d"),o=t.n(r);function i(e){e.style.opacity=0,e.style["margin-left"]="5rem"}function a(e,n){var t=150*(e.dataset.index||0);setTimeout((function(){o()(e,{"margin-left":"",opacity:1},{complete:n})}),t)}function c(e,n){return this.beforeEnter(e)}},eff1:function(e,n,t){"use strict";t.r(n);var r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("SearchOptions",{on:{onSearch:e.onSearch},model:{value:e.search,callback:function(n){e.search=n},expression:"search"}}),e._v(" "),t("el-dialog",{attrs:{visible:e.show_result,width:"mobile"===e.device?"100%":"50%","append-to-body":""},on:{"update:visible":function(n){e.show_result=n}},scopedSlots:e._u([{key:"title",fn:function(){return[t("h3",[e._v("题库:"+e._s(e.database_data.alias)+"(共"+e._s(e.total_data_count)+"题)")])]},proxy:!0}])},[e._v(" "),t("SearchOptions",{attrs:{advance:!0},on:{onSearch:e.onSearch},model:{value:e.search,callback:function(n){e.search=n},expression:"search"}}),e._v(" "),t("transition-group",{staticClass:"slide-container",attrs:{name:"slide-fade",mode:"out-in",tag:"ul"},on:{enter:e.enter,"before-enter":e.beforeEnter,"before-leave":e.beforeLeave}},e._l(e.filtered_paged_problems,(function(e,n){return t("li",{key:e.id,staticClass:"slide-fade-item",attrs:{"data-index":n}},[t("Problem",{key:e.id,attrs:{show:!0,data:e,"only-read":!0}})],1)})),0),e._v(" "),t("Pagination",{attrs:{pagesetting:e.page,"total-count":e.filtered_problems.length},on:{"update:pagesetting":function(n){e.page=n}}})],1)],1)},o=[],i=(t("8e6e"),t("ac6a"),t("456d"),t("7514"),t("7f7f"),t("386d"),t("ade3")),a=t("9554"),c=t("e2dd"),u=t("2f62"),s=t("70eb"),l=t("05f3");function f(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?f(Object(t),!0).forEach((function(n){Object(i["a"])(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var p={name:"ProblemSearch",components:{Problem:function(){return t.e("chunk-399b4592").then(t.bind(null,"e39d"))},Pagination:function(){return t.e("chunk-2d0b95e7").then(t.bind(null,"333d"))},SearchOptions:function(){return t.e("chunk-2d208714").then(t.bind(null,"a58b"))}},props:{name:{type:String,default:null}},data:function(){return{loading:!1,search:{content:null,name:null,answer:null,option:null,count_wrong:0,count_right:0,count_total:0},database_data:{},problems:[],show_result:!1,page:{pageIndex:0,pageSize:5},total_data_count:0}},computed:d({filtered_paged_problems:function(){var e=this.page,n=this.filtered_problems,t=e.pageIndex*e.pageSize,r=t+e.pageSize;return n.slice(t,r)},filtered_problems:function(){var e=this.problems;if(!e)return[];var n=Object(a["a"])(this.search),t=n.reduce((function(e,n){return(e[n.k]=n.v)&&e}),{}),r=t.name,o=t.answer,i=t.option,c=t.count_wrong,u=t.count_right,s=t.count_total;return console.log({name:r,answer:o,option:i,count_wrong:c,count_right:u,count_total:s}),r&&r.map((function(n){n=n&&n.toLocaleLowerCase(),e=e.filter((function(e){return e&&e.content&&e.content.toLocaleLowerCase().indexOf(n)>-1}))})),o&&o.map((function(n){n=n&&n.toLocaleLowerCase(),e=e.filter((function(e){var t=e.answer;return!!t&&(t.push?t.find((function(e){return"".concat(e).toLocaleLowerCase().indexOf(n)>-1})):"".concat(t).toLocaleLowerCase().indexOf(n)>-1)}))})),i&&i.map((function(n){n=n&&n.toLocaleLowerCase(),e=e.filter((function(e){var t=e.options;return!!t&&t.find((function(e){return e&&e.toLocaleLowerCase().indexOf(n)>-1}))}))})),e}},Object(u["c"])({device:function(e){return e.app.device}})),watch:{name:{handler:function(){this.refresh()},immediate:!0}},methods:{beforeLeave:c["b"],enter:c["c"],beforeEnter:c["a"],onSearch:function(){this.show_result=!0},refresh:function(){var e=this,n=this.name;n&&(this.loading=!0,l["a"].get_database_detail(n).then((function(n){e.database_data=n,Object(s["a"])(n.problems).then((function(n){var t=n.problems,r=(n.duplicated,n.total_count);n.filter_record;e.problems=t,e.total_data_count=r}))})).finally((function(){e.loading=!1})))}}},b=p,m=t("2877"),h=Object(m["a"])(b,r,o,!1,null,"32b834b2",null);n["default"]=h.exports}}]);